<!-- Page Header -->
<div class="sigel-page-header mb-4">
  <div class="sigel-page-title">
    <iconify-icon icon="solar:layers-bold-duotone" class="sigel-page-icon"></iconify-icon>
    <h1 class="sigel-page-title-text">
      <%= t("activerecord.models.g_veiculo.other", default: "G veiculos") %>
    </h1>
  </div>
  <%= link_to new_g_veiculo_path, class: "btn btn-sigel-primary d-flex align-items-center gap-2" do %>
    <iconify-icon icon="solar:add-circle-bold-duotone"></iconify-icon>
    <span>Novo Registro</span>
  <% end %>
</div>
<!-- Filtros - Colapsável -->
<div class="mb-4">
  <button class="btn w-100 sigel-card sigel-filter-toggle" type="button" data-bs-toggle="collapse" data-bs-target="#filtrosForm">
    <span class="sigel-filter-title">
      <iconify-icon icon="solar:filter-bold-duotone"></iconify-icon>
      Filtros de Pesquisa
    </span>
    <iconify-icon
      icon="solar:chevron-down-bold"
      class="collapse-icon sigel-collapse-icon"
    ></iconify-icon>
  </button>
  <div class="collapse" id="filtrosForm">
    <div class="sigel-card sigel-filter-body">
      <div class="sigel-card-body">
        <%= search_form_for @q, url: g_veiculos_path, method: :get do |f| %>
          <div class="row g-3">
            <div class="col-lg-3 col-md-6">
              <label class="sigel-form-label">
                <strong>Numero interno</strong>
              </label>
              <%= f.search_field :numero_interno_cont, class: "form-control sigel-form-control", placeholder: "Pesquisar..." %>
            </div>
            <div class="col-lg-3 col-md-6">
              <label class="sigel-form-label">
                <strong>Tombamento</strong>
              </label>
              <%= f.search_field :tombamento_cont, class: "form-control sigel-form-control", placeholder: "Pesquisar..." %>
            </div>
            <div class="col-lg-3 col-md-6">
              <label class="sigel-form-label">
                <strong>Placa</strong>
              </label>
              <%= f.search_field :placa_cont, class: "form-control sigel-form-control", placeholder: "Pesquisar..." %>
            </div>
            <div class="col-lg-3 col-md-6">
              <label class="sigel-form-label">
                <strong>Chassi</strong>
              </label>
              <%= f.search_field :chassi_cont, class: "form-control sigel-form-control", placeholder: "Pesquisar..." %>
            </div>
            <div class="col-12 d-flex gap-2">
              <%= f.submit "Aplicar Filtros", class: "btn btn-sigel-primary d-flex align-items-center gap-2" %>
              <%= link_to g_veiculos_path, class: "btn btn-sigel-outline d-flex align-items-center gap-2" do %>
                <iconify-icon icon="solar:restart-bold-duotone"></iconify-icon>
                Limpar
              <% end %>
            </div>
          </div>
        <% end %>
      </div>
    </div>
  </div>
</div>
<!-- Tabela de Registros -->
<div class="sigel-card">
  <div class="sigel-card-header">
    <h5>
      <iconify-icon icon="solar:clipboard-list-bold-duotone" class="me-2"></iconify-icon>
      Lista de Registros
    </h5>
    <span class="badge sigel-badge-count">
      <%= @g_veiculos.total_count rescue @g_veiculos.count %> registros
    </span>
  </div>
  <div class="sigel-card-body p-0">
    <% if @g_veiculos.any? %>
      <div class="table-responsive">
        <table class="table sigel-table mb-0 align-middle">
          <thead>
            <tr>
              <th class="sigel-th">
                <%= sort_link(@q, :numero_interno, "Numero interno") %>
              </th>
              <th class="sigel-th">
                <%= sort_link(@q, :placa, "Placa") %>
              </th>
              <th class="sigel-th">
                <%= sort_link(@q, :chassi, "Chassi") %>
              </th>
              <th class="sigel-th">
                <%= sort_link(@q, :renavam, "Renavam") %>
              </th>
              <th class="sigel-th">
                <%= sort_link(@q, :marca, "Marca") %>
              </th>
              <th class="sigel-th">
                <%= sort_link(@q, :modelo, "Modelo") %>
              </th>
              <th class="sigel-th">
                <%= sort_link(@q, :ano, "Ano") %>
              </th>
              <th class="sigel-th">
                <%= sort_link(@q, :cor, "Cor") %>
              </th>
              <th class="sigel-th">
                <%= sort_link(@q, :motor, "Motor") %>
              </th>
              <th class="sigel-th">
                <%= sort_link(@q, :tombamento, "Tombamento") %>
              </th>
              <th class="sigel-th">
                <%= sort_link(@q, :g_status_veiculo, "G status veiculo") %>
              </th>
              <th class="sigel-th-actions">Ações</th>
            </tr>
          </thead>
          <tbody>
            <% @g_veiculos.each do |g_veiculo| %>
              <tr class="sigel-table-row">
                <td>
                  <%= truncate(g_veiculo.numero_interno.to_s) %>
                </td>
                <td>
                  <%= truncate(g_veiculo.placa.to_s) %>
                </td>
                <td>
                  <%= truncate(g_veiculo.chassi.to_s) %>
                </td>
                <td>
                  <%= truncate(g_veiculo.renavam.to_s) %>
                </td>
                <td>
                  <%= truncate(g_veiculo.marca.to_s) %>
                </td>
                <td>
                  <%= truncate(g_veiculo.modelo.to_s) %>
                </td>
                <td>
                  <%= truncate(g_veiculo.ano.to_s) %>
                </td>
                <td>
                  <%= truncate(g_veiculo.cor.to_s) %>
                </td>
                <td>
                  <%= truncate(g_veiculo.motor.to_s) %>
                </td>
                <td>
                  <%= truncate(g_veiculo.tombamento.to_s) %>
                </td>
                <td>
                  <%= truncate(g_veiculo.g_status_veiculo.to_s) %>
                </td>
                <td class="sigel-td-actions">
                  <div class="d-inline-flex gap-2 sigel-actions">
                    <%= link_to g_veiculo_path(g_veiculo), class: "sigel-action-btn", title: "Visualizar" do %>
                      <iconify-icon icon="solar:eye-bold"></iconify-icon>
                    <% end %>
                    <%= link_to edit_g_veiculo_path(g_veiculo), class: "sigel-action-btn", title: "Editar" do %>
                      <iconify-icon icon="solar:pen-bold"></iconify-icon>
                    <% end %>
                    <button type="button" class="sigel-action-btn sigel-action-btn-danger js-open-delete-modal" data-delete-url="<%= g_veiculo_path(g_veiculo) %>">
                      <iconify-icon icon="solar:trash-bin-trash-bold"></iconify-icon>
                    </button>
                  </div>
                </td>
              </tr>
            <% end %>
          </tbody>
        </table>
      </div>
      <!-- Paginação -->
      <div class="sigel-card-footer">
        <div class="d-flex justify-content-between align-items-center">
          <div class="text-muted">
            Exibindo <strong><%= @g_veiculos.size %></strong> de
            <strong><%= @g_veiculos.total_count rescue @g_veiculos.count %></strong> registros
          </div>
          <div>
            <% if defined?(@pagy) && @pagy.pages > 1 %>
              <%== pagy_bootstrap_nav(@pagy) %>
            <% end %>
          </div>
        </div>
      </div>
    <% else %>
      <div class="sigel-empty-state">
        <iconify-icon icon="solar:folder-open-bold-duotone" class="sigel-empty-icon"></iconify-icon>
        <h5 class="mt-3 sigel-empty-title">Nenhum registro encontrado</h5>
        <p class="text-muted">Cadastre um novo registro para começar</p>
        <%= link_to new_g_veiculo_path, class: "btn btn-sigel-primary mt-3" do %>
          <iconify-icon icon="solar:add-circle-bold-duotone" class="me-2"></iconify-icon>
          Novo Registro
        <% end %>
      </div>
    <% end %>
  </div>
</div>
