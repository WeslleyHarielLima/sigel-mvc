<div class="d-flex justify-content-between align-items-center mb-4">
  <h1><i class="bi bi-car-front"></i> Veículos</h1>
  <%= link_to new_g_veiculo_path, class: "btn btn-primary" do %>
    <i class="bi bi-plus-lg"></i> Novo Veículo
  <% end %>
</div>

<!-- Filtros -->
<div class="card mb-4">
  <div class="card-header">
    <h5 class="mb-0"><i class="bi bi-funnel"></i> Filtros</h5>
  </div>
  <div class="card-body">
    <%= search_form_for @q, url: g_veiculos_path, method: :get, html: { class: "row g-3" } do |f| %>
      <div class="col-md-3">
        <%= f.label :placa_cont, "Placa", class: "form-label" %>
        <%= f.search_field :placa_cont, class: "form-control", placeholder: "Buscar por placa" %>
      </div>
      <div class="col-md-3">
        <%= f.label :marca_cont, "Marca", class: "form-label" %>
        <%= f.search_field :marca_cont, class: "form-control", placeholder: "Buscar por marca" %>
      </div>
      <div class="col-md-3">
        <%= f.label :modelo_cont, "Modelo", class: "form-label" %>
        <%= f.search_field :modelo_cont, class: "form-control", placeholder: "Buscar por modelo" %>
      </div>
      <div class="col-md-3">
        <%= f.label :status_eq, "Status", class: "form-label" %>
        <%= f.select :status_eq, options_for_select(GVeiculo::STATUSES.map { |k, v| [v, k] }, params.dig(:q, :status_eq)), { include_blank: "Todos" }, class: "form-select" %>
      </div>
      <div class="col-md-3">
        <%= f.label :g_tipo_veiculo_id_eq, "Tipo", class: "form-label" %>
        <%= f.select :g_tipo_veiculo_id_eq, options_for_select(GTipoVeiculo.order(:descricao).pluck(:descricao, :id), params.dig(:q, :g_tipo_veiculo_id_eq)), { include_blank: "Todos" }, class: "form-select" %>
      </div>
      <div class="col-md-3">
        <%= f.label :apto_eq, "Apto", class: "form-label" %>
        <%= f.select :apto_eq, options_for_select([["Sim", true], ["Não", false]], params.dig(:q, :apto_eq)), { include_blank: "Todos" }, class: "form-select" %>
      </div>
      <div class="col-md-6 d-flex align-items-end gap-2">
        <%= f.submit "Filtrar", class: "btn btn-primary" %>
        <%= link_to "Limpar", g_veiculos_path, class: "btn btn-outline-secondary" %>
      </div>
    <% end %>
  </div>
</div>

<!-- Lista de Veículos -->
<div class="card">
  <div class="card-body">
    <% if @g_veiculos.any? %>
      <div class="table-responsive">
        <table class="table table-striped table-hover">
          <thead class="table-light">
            <tr>
              <th>Placa</th>
              <th>Marca/Modelo</th>
              <th>Ano</th>
              <th>Tipo</th>
              <th>Status</th>
              <th>Apto</th>
              <th class="table-actions">Ações</th>
            </tr>
          </thead>
          <tbody>
            <% @g_veiculos.each do |veiculo| %>
              <tr>
                <td><strong><%= veiculo.placa %></strong></td>
                <td><%= "#{veiculo.marca} #{veiculo.modelo}" %></td>
                <td><%= veiculo.ano %></td>
                <td><%= veiculo.g_tipo_veiculo&.descricao %></td>
                <td>
                  <span class="badge badge-<%= veiculo.status %> text-white">
                    <%= veiculo.status_label %>
                  </span>
                </td>
                <td>
                  <% if veiculo.apto? %>
                    <span class="badge bg-success"><i class="bi bi-check-lg"></i> Sim</span>
                  <% else %>
                    <span class="badge bg-secondary"><i class="bi bi-x-lg"></i> Não</span>
                  <% end %>
                </td>
                <td class="table-actions">
                  <%= link_to g_veiculo_path(veiculo), class: "btn btn-sm btn-outline-info" do %>
                    <i class="bi bi-eye"></i>
                  <% end %>
                  <%= link_to edit_g_veiculo_path(veiculo), class: "btn btn-sm btn-outline-warning" do %>
                    <i class="bi bi-pencil"></i>
                  <% end %>
                  <%= button_to g_veiculo_path(veiculo), method: :delete, class: "btn btn-sm btn-outline-danger", data: { turbo_confirm: "Tem certeza que deseja excluir este veículo?" } do %>
                    <i class="bi bi-trash"></i>
                  <% end %>
                </td>
              </tr>
            <% end %>
          </tbody>
        </table>
      </div>

      <div class="pagination-container">
        <%== pagy_bootstrap_nav(@pagy) if @pagy.pages > 1 %>
      </div>
    <% else %>
      <div class="alert alert-info">
        <i class="bi bi-info-circle"></i> Nenhum veículo encontrado.
      </div>
    <% end %>
  </div>
</div>
