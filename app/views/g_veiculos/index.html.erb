<div class="d-flex justify-content-between align-items-center mb-4">
  <h5 class="card-title fw-semibold mb-0"><i class="ti ti-car me-2"></i>Veículos</h5>
  <%= link_to new_g_veiculo_path, class: "btn btn-primary" do %>
    <i class="ti ti-plus"></i> Novo Veículo
  <% end %>
</div>

<!-- Filtros -->
<div class="card mb-4">
  <div class="card-header bg-light-primary">
    <h6 class="mb-0"><i class="ti ti-filter me-1"></i> Filtros</h6>
  </div>
  <div class="card-body">
    <%= search_form_for @q, url: g_veiculos_path, method: :get, html: { class: "row g-3" } do |f| %>
      <div class="col-md-3">
        <%= f.label :placa_cont, "Placa", class: "form-label" %>
        <%= f.search_field :placa_cont, class: "form-control", placeholder: "Buscar por placa" %>
      </div>
      <div class="col-md-3">
        <%= f.label :marca_cont, "Marca", class: "form-label" %>
        <%= f.search_field :marca_cont, class: "form-control", placeholder: "Buscar por marca" %>
      </div>
      <div class="col-md-3">
        <%= f.label :modelo_cont, "Modelo", class: "form-label" %>
        <%= f.search_field :modelo_cont, class: "form-control", placeholder: "Buscar por modelo" %>
      </div>
      <div class="col-md-3">
        <%= f.label :status_eq, "Status", class: "form-label" %>
        <%= f.select :status_eq, options_for_select(GVeiculo::STATUSES.map { |k, v| [v, k] }, params.dig(:q, :status_eq)), { include_blank: "Todos" }, class: "form-select" %>
      </div>
      <div class="col-md-3">
        <%= f.label :g_tipo_veiculo_id_eq, "Tipo", class: "form-label" %>
        <%= f.select :g_tipo_veiculo_id_eq, options_for_select(GTipoVeiculo.order(:descricao).pluck(:descricao, :id), params.dig(:q, :g_tipo_veiculo_id_eq)), { include_blank: "Todos" }, class: "form-select" %>
      </div>
      <div class="col-md-3">
        <%= f.label :apto_eq, "Apto", class: "form-label" %>
        <%= f.select :apto_eq, options_for_select([["Sim", true], ["Não", false]], params.dig(:q, :apto_eq)), { include_blank: "Todos" }, class: "form-select" %>
      </div>
      <div class="col-md-6 d-flex align-items-end gap-2">
        <%= f.submit "Filtrar", class: "btn btn-primary" %>
        <%= link_to "Limpar", g_veiculos_path, class: "btn btn-outline-secondary" %>
      </div>
    <% end %>
  </div>
</div>

<!-- Lista de Veículos -->
<div class="card">
  <div class="card-body">
    <% if @g_veiculos.any? %>
      <div class="table-responsive">
        <table class="table text-nowrap mb-0 align-middle">
          <thead class="text-dark fs-4">
            <tr>
              <th class="border-bottom-0"><h6 class="fw-semibold mb-0">Placa</h6></th>
              <th class="border-bottom-0"><h6 class="fw-semibold mb-0">Marca/Modelo</h6></th>
              <th class="border-bottom-0"><h6 class="fw-semibold mb-0">Ano</h6></th>
              <th class="border-bottom-0"><h6 class="fw-semibold mb-0">Tipo</h6></th>
              <th class="border-bottom-0"><h6 class="fw-semibold mb-0">Status</h6></th>
              <th class="border-bottom-0"><h6 class="fw-semibold mb-0">Apto</h6></th>
              <th class="border-bottom-0"><h6 class="fw-semibold mb-0">Ações</h6></th>
            </tr>
          </thead>
          <tbody>
            <% @g_veiculos.each do |veiculo| %>
              <tr>
                <td class="border-bottom-0">
                  <p class="mb-0 fw-semibold"><%= veiculo.placa %></p>
                </td>
                <td class="border-bottom-0">
                  <p class="mb-0"><%= "#{veiculo.marca} #{veiculo.modelo}" %></p>
                </td>
                <td class="border-bottom-0">
                  <p class="mb-0"><%= veiculo.ano %></p>
                </td>
                <td class="border-bottom-0">
                  <span class="badge bg-light-primary text-primary"><%= veiculo.g_tipo_veiculo&.descricao %></span>
                </td>
                <td class="border-bottom-0">
                  <span class="badge badge-<%= veiculo.status %> text-white">
                    <%= veiculo.status_label %>
                  </span>
                </td>
                <td class="border-bottom-0">
                  <% if veiculo.apto? %>
                    <span class="badge bg-success"><i class="ti ti-check"></i> Sim</span>
                  <% else %>
                    <span class="badge bg-secondary"><i class="ti ti-x"></i> Não</span>
                  <% end %>
                </td>
                <td class="border-bottom-0">
                  <div class="d-flex gap-1">
                    <%= link_to g_veiculo_path(veiculo), class: "btn btn-sm btn-light-info rounded-circle" do %>
                      <i class="ti ti-eye"></i>
                    <% end %>
                    <%= link_to edit_g_veiculo_path(veiculo), class: "btn btn-sm btn-light-warning rounded-circle" do %>
                      <i class="ti ti-pencil"></i>
                    <% end %>
                    <%= button_to g_veiculo_path(veiculo), method: :delete, class: "btn btn-sm btn-light-danger rounded-circle", data: { turbo_confirm: "Tem certeza que deseja excluir este veículo?" } do %>
                      <i class="ti ti-trash"></i>
                    <% end %>
                  </div>
                </td>
              </tr>
            <% end %>
          </tbody>
        </table>
      </div>

      <div class="pagination-container mt-3">
        <%== pagy_bootstrap_nav(@pagy) if @pagy.pages > 1 %>
      </div>
    <% else %>
      <div class="alert alert-info mb-0">
        <i class="ti ti-info-circle me-1"></i> Nenhum veículo encontrado.
      </div>
    <% end %>
  </div>
</div>
